<script>

    $(document).ready(function () {


        //showmodel全屏，偵測手機高度
        let y =$(window).height();
        let h =(y-70)+"px";
        //let top= (y-80)+"px"
        //將css的變數取出
            //var bodyStyles = window.getComputedStyle(document.body);
            //var fooBar = bodyStyles.getPropertyValue('--height'); //get
        document.body.style.setProperty('--height', h);//set
        
    
        //判斷是用電腦還手機
        let x= $(window).width(); 
        //alert(x+"and"+y); 
        if(x>450){
            $("#t_close").show();
            $("#o_close").show();
            $("#b_close").hide();
        }
        else{
           // $("#edit").modal("hide");
            $("#t_close").hide();
            $("#o_close").hide();
            $("#b_close").show();   
        }



        //螢幕縮放偵測
        $(window).resize(function(){
            
            let rx= $(window).width();
           
            if(rx>520){
                $("#t_close").show();
                $("#o_close").show();
                $("#b_close").hide();
            }
            else{
                $("#t_close").hide();
                $("#o_close").hide();
                $("#b_close").show();

            }
            //有人的手機長度會改嗎???
            let ry =$(window).height();
            let h =(ry-80)+"px";
            document.body.style.setProperty('--height', h);//set

       })

        CKEDITOR.replace('add_text', {
            
            filebrowserUploadUrl: '/uploader',
        });

        //大學生研究生的動畫
        $(".under").mouseover(function () {
            $(".gra").removeClass("big").addClass("small");

        });
        $(".gra").mouseover(function () {
            $(".under").removeClass("big").addClass("small");
        });


        $(".gra").mouseleave(function () {
            if(gra==true){
                $(".gra").removeClass("small").addClass("big");
                $(".under").removeClass("big").addClass("small");
            }else{
                $(".under").removeClass("small").addClass("big");
                $(".gra").removeClass("big").addClass("small");
            }
        });

        $(".under").mouseleave(function () {
            if(under==true){
                $(".under").removeClass("small").addClass("big");
                $(".gra").removeClass("big").addClass("small");
            }else{
                $(".gra").removeClass("small").addClass("big");
                $(".under").removeClass("big").addClass("small");
            }
        });
        //預設為大學生
        $(".graduate").hide();
        $(".undergraduate").show();
        var gra;
        var under;
        //大學生研究生選擇
        $(".gra").mousedown(function () {
            /*tab字*/
            $("a.nav-link").css("color","black");
            /*不支援這方法，要另找，但我好累
           $("a.nav-link:hover").css("background-color","red");*/
            $(".gra").removeClass("small").addClass("big");
            $(".under").removeClass("big").addClass("small");

            gra=true;
            under=false; 
            $("body").css("background-image","url('m_b.png')");
            $(".graduate").show();
            $(".undergraduate").hide();
           

        });
        $(".under").mousedown(function () {
            $("a.nav-link").css("color","black")
            $(".nav-item:hover").css({"background-color":"#F8F8F8"," border-radius":"6px"});
            $(".under").removeClass("small").addClass("big");
            $(".gra").removeClass("big").addClass("small");
            under=true;
            gra=false;
            $("body").css("background-image","url('s_b.png')");
            $(".graduate").hide();
            $(".undergraduate").show();
        });
       


    <%_ if (user && user.role === 'admin'){-%>
       
        $(".box").mousedown(function () {
            $("header").hide();
            //抓按下按鈕的id
            let count = 0;
            let textid = this.id;
            $("#edit").modal("show");

            //將js的變數給html裡的form action
            $('#add').attr('action', "/documents/edit/" + textid);

            $.ajax({
                url: "/documents/require_data/" + textid,
                method: 'get',
                error: function (err) {
                    console.log(err);
                },
                success: function (data) {
                    
                    $("#edit_title").val(data.title);
                    CKEDITOR.instances.edit_content.setData(data.content);
                }
            });

            $("#save").click(function(){
                $("#edit").modal("hide");
                $("header").show();
            });
                            
        });
    <%_ } -%>

        //使用者
        $(".box").mousedown(function () {
            $("header").hide();

            let count = 0;
            let textid = this.id;
            $("#show").modal("show");

            $.ajax({
                url: "/documents/require_data/" + textid,
                method: 'get',
                error: function (err) {
                    console.log(err);
                },
                success: function (data) {

                    $("#show_title").html(data.title);
                    $("#show_content").html(data.content);

                }
            });
        });
        $("#t_close").mousedown(function () {
            $("header").show();
        });
        $("#o_close").mousedown(function () {
            $("header").show();
        });        
        $("#b_close").mousedown(function () {
            $("header").show();
        });
        

        /*modal出來時外面滾輪不會動*/
        $(".modal").on('hide.bs.modal', function () {
            $("body").css({
                "overflow":"auto"
            });
         });
        $(".modal").on('show.bs.modal', function () {
            $("body").css({
                "overflow":"hidden"
            });
         });
              
        /*處理ckeditor與modal相容的問題，之後發現刪除tabindex="-1"也可
        $('.modal').removeAttr('tabindex');

        $('.modal').focusout(function(){
            $(this).css({'position':'relative'});
        });

        $('.modal').focusin(function(){
            $(this).css({'position':'fixed'});
        }); */





    })


</script>