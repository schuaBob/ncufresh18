<script>
    
    $(document).ready(function(){

        let y =$(window).height();
        let h =(y-65)+"px"
        document.body.style.setProperty('--height', h);
        
        $(".learn").mousedown(function(){
            $(".learns").show();
            $(".plays").hide();
            $(".dates").hide();
            $(".services").hide();
        });

        $(".play").mousedown(function(){
            $(".plays").show();
            $(".learns").hide();
            $(".dates").hide();
            $(".services").hide();
        });

        $(".date").mousedown(function(){
            $(".dates").show();
            $(".learns").hide();
            $(".plays").hide();
            $(".services").hide();
        });

        $(".service").mousedown(function(){
            $(".services").show();
            $(".learns").hide();
            $(".plays").hide();
            $(".dates").hide();
        });
        
        <%_ if (user && user.role === 'admin'){ -%>
            CKEDITOR.replace('add_introduction',{
                filebrowserUploadUrl: '/uploader',
            });
            CKEDITOR.replace('add_participation',{
                filebrowserUploadUrl: '/uploader',
            });
            CKEDITOR.replace('add_FB',{
                filebrowserUploadUrl: '/uploader',
            });
            CKEDITOR.replace('add_activity',{
                filebrowserUploadUrl: '/uploader',
            });

            CKEDITOR.editorConfig = function (config){
                config.enterMode = CKEDITOR.ENTER_BR;
                config.autoParagraph = false;
            };
        <%_ } -%> 

        // 每次變更畫面大小時偵測
        $(window).resize(function(){
            if($(window).width()<=768){
                $("#nav_ul").removeClass("flex-column");
                $("#cellup").show();
                $(".bread").hide();
                $("#combut").hide();
                $(".sidedown").show();
                $(".titleup").show();
            }
            else if($(window).width()>768){
                $("#nav_ul").addClass("flex-column");
                $("#combut").show();
                $("#cellup").hide();
                $(".sidedown").hide();
                $("#combut").show();
                $(".titleup").hide();
            }
        });
        // 一開始偵測
        if($(window).width()<=768){
            $("#nav_ul").removeClass("flex-column");
            $("#cellup").show();
            $(".bread").hide();
            $("#combut").hide();
            $(".sidedown").show();
            $(".titleup").show();
        }
        else if($(window).width()>768){
            $("#nav_ul").addClass("flex-column");
            $("#combut").show();
            $("#cellup").hide();
            $(".sidedown").hide();
            $("#combut").show();
            $(".titleup").hide();
        }

        $('.open').click(function (event) {
            //console.log(event);
            $.ajax({
                url: "clubmodal?id=" + event.currentTarget.attributes.search.value,
                method: "GET",
                error: function (err) {

                },
                success: function (data_club) {
                    console.log(data_club);
                    $('#clubmodal .modal-title').text(data_club.name)
                    $('#clubmodal .intro').html(data_club.introduction)
                    $('#clubmodal .parti').html(data_club.participation)
                    $('#clubmodal .fb').html(data_club.FB)
                    $('#clubmodal .acti').html(data_club.activity)
                    for (let i = 0; i < data_club.intro_pic.length; i++) {
                        $('#carouselExampleIndicator1 .carousel-indicators').append("<li data-target='#carouselExampleIndicator1' data-slide-to='" + i + "'></li>")
                        $('#carouselExampleIndicator1 .carousel-inner').append("<div class='carousel-item'><img class='d-block w-100' src='/groups/img/" + data_club.intro_pic[i] + "'></div>")
                    }
                    $('#carouselExampleIndicator1 .carousel-indicators li').first().addClass('active')
                    $('#carouselExampleIndicator1 .carousel-inner div').first().addClass('active')
                    $('#clubmodal').on('hide.bs.modal', function (e) {
                        $('#carouselExampleIndicator1 .carousel-indicators li').remove()
                        $('#carouselExampleIndicator1 .carousel-inner .carousel-item').remove()
                        $('#clubmodal').off('hide.bs.modal')
                    })
                    for (let i = 0; i < data_club.act_pic.length; i++) {
                        $('#carouselExampleIndicator2 .carousel-indicators').append("<li data-target='#carouselExampleIndicator2' data-slide-to='" + i + "'></li>")
                        $('#carouselExampleIndicator2 .carousel-inner').append("<div class='carousel-item'><img class='d-block w-100' src='/groups/img/" + data_club.act_pic[i] + "'></div>")
                    }
                    $('#carouselExampleIndicator2 .carousel-indicators li').first().addClass('active')
                    $('#carouselExampleIndicator2 .carousel-inner div').first().addClass('active')
                    $('#clubmodal').on('hide.bs.modal', function (e) {
                        $('#carouselExampleIndicator2 .carousel-indicators li').remove()
                        $('#carouselExampleIndicator2 .carousel-inner .carousel-item').remove()
                        $('#clubmodal').off('hide.bs.modal')
                    })

                    
                    $('#clubmodal').modal('show')
                }
            })
        })
    });
</script>