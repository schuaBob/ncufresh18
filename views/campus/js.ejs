<script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.0/velocity.min.js"></script>
<script>

    $(document).ready(function () {

        var temp;
        var properties = null
        var seq = null
        var array1 = []



        $('.modal-header span i').click(function () {
            $('#indexmodal').modal('hide')
        })

        $('.indexelepic').hover(function () {
            $(this).velocity({ scale: 1.1}, 100)
        }, function () {
            $(this).velocity({ scale: 1}, 100)
        })
        $('.indexelepic').click(function (event) {
            $('.indexelepic').tooltip('hide');
            $.ajax({
                url: "indexmodal?id=" + event.currentTarget.attributes.alt.value,
                method: "GET",
                error: function (err) {

                },
                success: function (data) {
                    $('#indexmodal .modal-title').text(data.Element_Name)
                    $('#indexmodalp .p').html(data.Element_Intro)
                    for (let i = 0; i < data.Intropic.length; i++) {
                        $('.carousel-indicators').append("<li data-target='#carouselExampleIndicators' data-slide-to='" + i + "'></li>")
                        $('#carouselExampleIndicators .carousel-inner').append("<div class='carousel-item'><img class='d-block w-100' src='/campus/" + data.Intropic[i] + "'></div>")
                    }
                    $('.carousel-indicators li').first().addClass('active')
                    $('#carouselExampleIndicators .carousel-inner div').first().addClass('active')
                    $('#indexmodal').on('hide.bs.modal', function (e) {
                        $('.carousel-indicators li').remove()
                        $('#carouselExampleIndicators .carousel-inner .carousel-item').remove()
                        $('#indexmodal').off('hide.bs.modal')
                    })




                    $('#indexmodal').modal('show')


                }
            })
        })
        $('#List_index li').hover(function (event) {
            $('.indexelepic[val=' + event.currentTarget.attributes.val.value + ']').velocity({ scale: 1.1}, 100)
            $('.indexelepic[val=' + event.currentTarget.attributes.val.value + ']').stop().tooltip('show')
        }, function (event) {
            $('.indexelepic[val=' + event.currentTarget.attributes.val.value + ']').velocity({ scale: 1}, 100)
            $('.indexelepic[val=' + event.currentTarget.attributes.val.value + ']').stop().tooltip('hide')
        })
        $('#List_index li').click(function (event) {
            $('.indexelepic[val=' + event.currentTarget.attributes.val.value + ']').stop().tooltip('hide')
            $('.elelist').hide()

            array1 = ["系館", "運動", "餐廳", "設施", "住宿", "行政", "活動場地", "緊急醫療"]
            for (let i = 1; i <= 8; i++) {
                if (event.currentTarget.attributes.val.value == i) {

                    if ($(this)[0] === temp) {
                        if ($('.main_list_detail').hasClass('clicked')) {
                            temp = $(this)[0]
                            console.log("1")

                            $('.main_list_detail').stop().collapse('hide')
                            $('.main_list_detail').removeClass('clicked')
                            $('#map').css("filter", "none")
                            $('.indexelepic').css("filter", "none")



                        } else {
                            console.log("2")
                            temp = $(this)[0]
                            $('#listtitle').text(array1[i - 1])
                            $('.main_list_detail li[val=' + i + ']').show()
                            $('.main_list_detail').stop().collapse('show')
                            $('.main_list_detail').addClass('clicked')
                            $('#map').css("filter", "brightness(55%)")
                            $('.indexelepic').css("filter", "brightness(55%)")
                            $('.indexelepic[val=' + event.currentTarget.attributes.val.value + ']').css("filter", "none")
                        }


                        if ($('.mapmove').hasClass('clicked')) {
                            properties = {
                                'margin-right': '15%',
                                'margin-left': '16%'
                            };

                            $('.mapmove').removeClass('clicked')
                        } else {
                            properties = {
                                'margin-left': '2%',
                                'margin-right': '29%'
                            };

                            $('.mapmove').addClass('clicked')
                        }
                    } else {
                        temp = $(this)[0]
                        properties = {
                            'margin-left': '2%',
                            'margin-right': '29%'
                        };
                        $('.mapmove').addClass('clicked')
                        if ($('.main_list_detail').hasClass('clicked')) {
                            console.log("3")
                            $('.main_list_detail').stop().collapse('hide')
                            $('.main_list_detail li[val=' + i + ']').show()
                            $('.main_list_detail').on('hidden.bs.collapse', function () {
                                $('#listtitle').text(array1[i - 1])
                                $('.main_list_detail').stop().collapse('show')
                                $('.main_list_detail').off('hidden.bs.collapse');
                            })
                            $('.main_list_detail').addClass('clicked')
                            $('.indexelepic').css("filter", "brightness(55%)")
                            $('.indexelepic[val=' + event.currentTarget.attributes.val.value + ']').css("filter", "none")
                        } else {
                            console.log("4")
                            $('#listtitle').text(array1[i - 1])
                            $('.main_list_detail li[val=' + i + ']').show()
                            $('.main_list_detail').stop().collapse('show')
                            $('.main_list_detail').addClass('clicked')
                            $('#map').css("filter", "brightness(55%)")
                            $('.indexelepic').css("filter", "brightness(55%)")
                            $('.indexelepic[val=' + event.currentTarget.attributes.val.value + ']').css("filter", "none")




                        }

                    }

                }
            }
            $('.mapmove').stop().velocity(properties, 400)
            console.log(temp);
        })
        $('#closemainlist').click(function () {
            $('#map').css("filter", "none")
            $('.indexelepic').css("filter", "none")
            $('.main_list_detail').stop().collapse('hide')
            $('.main_list_detail').removeClass('clicked')
            $('.mapmove').removeClass('clicked')
            properties = {
                'margin-right': '15%',
                'margin-left': '16%'
            };
            $('.mapmove').stop().velocity(properties, 400)
        })
        $('.elelist').hover(function (event) {
            $('.indexelepic[alt=' + event.currentTarget.attributes.idconnect.value + ']').velocity({ scale: 1.1}, 100)
            $('.indexelepic[alt=' + event.currentTarget.attributes.idconnect.value + ']').tooltip('show')
        }, function () {
            $('.indexelepic[alt=' + event.currentTarget.attributes.idconnect.value + ']').velocity({ scale: 1}, 100)
            $('.indexelepic[alt=' + event.currentTarget.attributes.idconnect.value + ']').tooltip('hide')
        })
        $('.elelist').click(function (event) {
            $('.indexelepic[alt=' + event.currentTarget.attributes.idconnect.value + ']').tooltip('hide')
            $.ajax({
                url: "indexmodal?id=" + event.currentTarget.attributes.idconnect.value,
                method: "GET",
                error: function (err) {

                },
                success: function (data) {
                    $('#indexmodal .modal-title').text(data.Element_Name)
                    $('#indexmodalp .p').html(data.Element_Intro)
                    for (let i = 0; i < data.Intropic.length; i++) {
                        $('.carousel-indicators').append("<li data-target='#carouselExampleIndicators' data-slide-to='" + i + "'></li>")
                        $('#carouselExampleIndicators .carousel-inner').append("<div class='carousel-item'><img class='d-block w-100' src='/campus/" + data.Intropic[i] + "'></div>")
                    }
                    $('.carousel-indicators li').first().addClass('active')
                    $('#carouselExampleIndicators .carousel-inner div').first().addClass('active')
                    $('#indexmodal').on('hide.bs.modal', function (e) {
                        $('.carousel-indicators li').remove()
                        $('#carouselExampleIndicators .carousel-inner .carousel-item').remove()
                        $('#indexmodal').off('hide.bs.modal')
                    })
                    $('#indexmodal').modal('show')

                }
            })
        })

    })
    $('.indexelepic').tooltip();



</script>